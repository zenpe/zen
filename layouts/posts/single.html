{{ define "main" }}
  {{ with .Params.featured_image }}
    <div class="post-featured-image">
      <img src="{{ . | absURL }}" alt="{{ $.Title }}" />
    </div>
  {{ end }}
  <div class="post-detail-card">
    <h1 class="post-detail-title">{{ .Title }}</h1>
    <div class="post-detail-meta">
      <span class="meta-item"><span class="meta-icon">ğŸ—“ï¸</span> {{ .Date.Format "2006-01-02" }}</span>
      {{ with .Params.categories }} 
      <span class="meta-item"><span class="meta-icon">ğŸ“</span> {{ delimit . ", " }}</span>
      {{ end }}
      {{ with .Params.author }} 
      <span class="meta-item"><span class="meta-icon">âœï¸</span> {{ . }}</span>
      {{ end }}
      <span class="meta-item" id="page-views">
        <span class="meta-icon">ğŸ‘ï¸</span>
        <span class="meta-text">é˜…è¯»é‡: <span id="busuanzi_value_page_pv">-</span> æ¬¡</span>
        <span class="loading-dots">
          <span>.</span><span>.</span><span>.</span>
        </span>
      </span>
    </div>
    <div class="post-detail-content">
      {{ .Content }}
    </div>
    <div class="post-detail-tags">
      {{ partial "terms.html" (dict "taxonomy" "tags" "page" .) }}
    </div>
  </div>

  <script>
    // é¡µé¢åŠ è½½å®Œæˆåå°è¯•è·å–è®¿é—®é‡æ•°æ®
    document.addEventListener('DOMContentLoaded', function() {
      // å¦‚æœBusuanziè„šæœ¬å°šæœªåŠ è½½ï¼Œåˆ™åŠ¨æ€åŠ è½½
      if (typeof busuanzi === 'undefined') {
        const script = document.createElement('script');
        script.src = '//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js';
        script.async = true;
        document.head.appendChild(script);
        
        // æ·»åŠ åŠ è½½åŠ¨ç”»
        const viewsElement = document.getElementById('page-views');
        viewsElement.classList.add('loading');
      }
      
      // å½“BusuanziåŠ è½½å®Œæˆæ—¶ç§»é™¤åŠ è½½åŠ¨ç”»
      window.pure_mini_js_loaded = function() {
        const viewsElement = document.getElementById('page-views');
        viewsElement.classList.remove('loading');
      };
    });
  </script>
{{ end }}